<!doctype html>
<html lang="hu">
<style>
/* iOS kattintási bug javítása checkboxokra */
input[type="checkbox"] {
  pointer-events: auto !important;
  position: relative;
  z-index: 10;
  transform: scale(1.2);
}

label {
  pointer-events: auto !important;
}

.task, .task-row, .item {
  pointer-events: auto;
}
/* Checkbox fix iOS WebApp-hoz */
input[type="checkbox"] {
  position: relative;
  z-index: 1000 !important; /* legfelülre */
  pointer-events: auto !important;
  transform: scale(1.5);      /* nagyobb, könnyebben érinthető */
}
label {
  pointer-events: auto !important;
  display: inline-block;
  cursor: pointer;
}  
</style>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Saját FlyLady App</title>
<style>
body { font-family: system-ui, -apple-system, Arial; margin:0; background:#f5f6f7; }
nav { display:flex; gap:6px; padding:8px; background:#fff; position:sticky; top:0; border-bottom:1px solid #ddd; }
nav button { flex:1; padding:10px; border:0; border-radius:8px; background:#eee; }
nav button.active { background:#cfe3ff; }
section { padding:12px; display:none; }
section.active { display:block; }
.item { display:flex; align-items:center; gap:8px; padding:8px; background:#fff; border-radius:8px; margin-bottom:6px; }
.small { color:#666; font-size:12px; }
.zone-active { border-left:6px solid #4f7cff; padding-left:6px; }
.badge { font-size:12px; padding:2px 6px; border-radius:6px; background:#e8f0ff; }
.timer button{margin-right:6px;}
</style>
</head>
<body>

<nav>
  <button data-tab="daily" class="active">Napi rutin</button>
  <button data-tab="weekly">Heti rutin</button>
  <button data-tab="zones">Zónák</button>
  <button data-tab="todo">Megoldandók</button>
  <button data-tab="settings">Mentés</button>
</nav>

<section id="daily" class="active">
  <h3>Reggel</h3>
  <div id="daily-morning"></div>
  <h3>Napközben</h3>
  <div id="daily-day"></div>
  <h3>Este</h3>
  <div id="daily-evening"></div>
</section>

<section id="weekly">
  <h3>Heti rutin</h3>
  <div id="weekly-list"></div>
</section>

<section id="zones">
  <div id="zones-list"></div>
</section>

<section id="todo">
  <input id="todo-input" placeholder="Új megoldandó..." />
  <button onclick="addTodo()">Hozzáad</button>
  <div id="todo-list"></div>
</section>

<section id="settings">
  <button onclick="exportData()">Adatok mentése</button>
  <input type="file" id="importFile" />
  <button onclick="importData()">Visszatöltés</button>
  <div class="timer">
    <h3>Időzítők</h3>
    <button onclick="startTimer(2)">2 perc</button>
    <button onclick="startTimer(5)">5 perc</button>
    <button onclick="startTimer(15)">15 perc</button>
  </div>
</section>

<script>
const $ = (q)=>document.querySelector(q);
const $$ = (q)=>document.querySelectorAll(q);

let data = JSON.parse(localStorage.getItem("flylady-data")||"null") || {
  daily:{morning:["Beágyazni mindkét szobában", "Reggelizni, D vitamin", "2 perc kritikus terület", "Mosogató",
                  "kis fürdőben WC turbó törlés", "Nézz rá a naptárra és a to do listára", "Kell-e ma mosni?",
                  "Felöltözni, fogat mosni, sminkelni", "Fésülködni, arckrém, sarokkrém"],
         day:["15 perc szanálás"],
         evening:["Ruhák előkészítése"]},
  weekly:["Heti tervezés","Hűtő átnézése"],
  zones:[
    {name:"Zóna 1 – Előszoba + nappali", tasks:[{t:"Padló felmosása", last:null, note:""}]},
    {name:"Zóna 2 – Étkező", tasks:[{t:"Függöny mosása", last:null, note:""}]},
    {name:"Zóna 3", tasks:[]},
    {name:"Zóna 4", tasks:[]},
    {name:"Zóna 5", tasks:[]},
  ],
  todo:[]
};

function save(){ localStorage.setItem("flylady-data", JSON.stringify(data)); render(); }

function render(){
  renderDaily(); renderWeekly(); renderZones(); renderTodo();
}
function renderDaily(){
  ["morning","day","evening"].forEach(k=>{
    const el = $("#daily-"+(k==="day"?"day":k));
    el.innerHTML="";
    data.daily[k].forEach((t,i)=>{
      el.innerHTML += `<label class="item"><input type="checkbox" onchange="this.checked=false"> ${t}</label>`;
    });
  });
}
function renderWeekly(){
  const el=$("#weekly-list"); el.innerHTML="";
  data.weekly.forEach(t=> el.innerHTML+=`<label class="item"><input type="checkbox" onchange="this.checked=false"> ${t}</label>`);
}
function renderZones(){
  const el=$("#zones-list"); el.innerHTML="";
  data.zones.forEach((z,zi)=>{
    let html = `<h3>${z.name}</h3>`;
    z.tasks.forEach((task,ti)=>{
      const last = task.last ? new Date(task.last).toLocaleDateString() : "—";
      html += `<div class="item">
        <input type="checkbox" onchange="data.zones[${zi}].tasks[${ti}].last=new Date().toISOString(); save()">
        ${task.t}
        <span class="small">utoljára: ${last}</span>
      </div>`;
    });
    el.innerHTML += html;
  });
}
function renderTodo(){
  const el=$("#todo-list"); el.innerHTML="";
  data.todo.forEach((t,i)=>{
    el.innerHTML += `<div class="item"><input type="checkbox" onchange="data.todo.splice(${i},1); save()">${t}</div>`;
  });
}
function addTodo(){
  const v=$("#todo-input").value.trim(); if(!v) return;
  data.todo.push(v); $("#todo-input").value=""; save();
}
function exportData(){
  const blob = new Blob([JSON.stringify(data,null,2)], {type:"application/json"});
  const a=document.createElement("a"); a.href=URL.createObjectURL(blob); a.download="flylady-backup.json"; a.click();
}
function importData(){
  const f=$("#importFile").files[0]; if(!f) return;
  const r=new FileReader();
  r.onload=()=>{ data=JSON.parse(r.result); save(); };
  r.readAsText(f);
}
function startTimer(m){
  const end = Date.now()+m*60000;
  const id = setInterval(()=>{
    if(Date.now()>=end){ clearInterval(id); alert(m+" perc letelt!"); }
  },500);
}
$$("nav button").forEach(b=>b.onclick=()=>{
  $$("nav button").forEach(x=>x.classList.remove("active"));
  $$("section").forEach(s=>s.classList.remove("active"));
  b.classList.add("active");
  $("#"+b.dataset.tab).classList.add("active");
});
render();
</script>
<script>
// iOS checkbox tap fix
document.addEventListener('click', function(e) {
  const el = e.target;
  if(el.tagName === 'INPUT' && el.type === 'checkbox') {
    el.checked = !el.checked; // állítsa a pipát
  }
}, true);
// iOS biztos pipálás
document.querySelectorAll('input[type="checkbox"]').forEach(cb => {
  cb.addEventListener('touchstart', e => {
    cb.checked = !cb.checked;
    e.preventDefault();
  });
});
</script> 
</body>

</html>
